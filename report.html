<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸»ç®¡ç®¡ç†å¿ƒæ³•åˆ†äº«</title>
<style>
    /* --- åŸæœ‰ CSS --- */
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        background-color: #f0f8ff;
        margin: 0; padding: 0;
        display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden;
    }
    #cover-page {
        width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;
        background: linear-gradient(to bottom, #87ceeb 0%, #f0f8ff 80%);
        text-align: center; transition: opacity 0.8s;
        position: absolute; top: 0; left: 0; z-index: 100;
    }
    #cover-page h1 { font-size: 3em; color: #005a9c; margin-bottom: 20px; }
    #cover-page .info { font-size: 1.2em; color: #333; margin: 8px 0; }
    #enter-btn { margin-top: 40px; padding: 15px 35px; font-size: 18px; font-weight: bold; color: white; background-color: #28a745;
        border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s, transform 0.2s; }
    #enter-btn:hover { background-color: #218838; transform: scale(1.05);}
    #flight-container {
        width: 90%; height: 80%; max-width: 1200px; max-height: 700px;
        border: 2px solid #ccc; border-radius: 15px; position: relative; overflow: hidden;
        background: linear-gradient(to bottom, #87ceeb 0%, #f0f8ff 80%); box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        display: none; opacity: 0; transition: opacity 0.8s;
    }
    #airplane {
        font-size: 40px; position: absolute; bottom: 5%; left: -10%; z-index: 10;
        transition: transform 0.5s, opacity 0.5s;
    }
    #path-canvas {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; pointer-events: none;
    }
    @keyframes takeoff-animation {
        0% { bottom: 5%; left: -10%; transform: rotate(0deg);}
        20% { transform: rotate(-20deg);}
        90% { transform: rotate(-5deg);}
        100% { bottom: 76%; left: 45%; transform: rotate(0deg);}
    }
    @keyframes cruising-animation {
        0% { left: 45%; transform: rotate(45deg);}
        50% { transform: translateY(-8px) rotate(46deg);}
        100% { bottom: 76%; left: 80%; transform: rotate(45deg);}  //abcdef
    }
    @keyframes landing-animation {
        0% { left: 80%; transform: rotate(45deg);}
        20% { transform: rotate(90deg);}
        100% { bottom: 5%; left: 120%; transform: rotate(90deg);}
    }
    .takeoff { animation: takeoff-animation 6s ease-in-out forwards;}
    .cruising { animation: cruising-animation 6s linear forwards;}
    .landing { animation: landing-animation 6s ease-in-out forwards;}

    /* --- ä¿®æ”¹å¾Œçš„ #info-panel æ¨£å¼ --- */
    #info-panel {
        position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
        width: 85%; max-width: 1000px; /* é™åˆ¶æœ€å¤§å¯¬åº¦ */
        padding: 20px; background: rgba(255,255,255,0.9);
        border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        opacity: 0; transition: opacity 1s; z-index: 20;
        min-height: 350px;
        display: flex; /* ä½¿ç”¨ Flexbox ä½ˆå±€ */
        flex-direction: row; /* å…§å®¹æ©«å‘æ’åˆ— */
        justify-content: space-between; /* æ–‡å­—å€å¡Šé å·¦ï¼Œæ›¸ç±å€å¡Šé å³ */
        align-items: flex-start; /* å…§å®¹é ‚éƒ¨å°é½Š */
        box-sizing: border-box; /* padding åŒ…å«åœ¨å¯¬åº¦å…§ */
    }
    #info-panel .info-content-left {
        flex: 1; /* æ–‡å­—å€å¡Šä½”æ“šå‰©é¤˜ç©ºé–“ */
        max-width: 65%; /* é™åˆ¶æ–‡å­—å€å¡Šæœ€å¤§å¯¬åº¦ï¼Œç¢ºä¿å³å´æœ‰è¶³å¤ ç©ºé–“ */
        padding-right: 20px; /* èˆ‡å³å´æ›¸ç±å€å¡Šçš„é–“éš” */
        box-sizing: border-box;
    }
    #info-panel h2 { color: #005a9c; margin-top: 0;}
    #info-panel p { font-style: italic; color: #d9534f; font-weight: bold; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px;}
    #info-points { list-style: none; padding: 0; width: 100%; text-align: left; } /* è®“ li å…§å®¹å·¦å°é½Š */
    #info-points li { margin: 10px 0; opacity: 0; transform: translateY(10px); transition: opacity 0.5s, transform 0.5s;}

    /* --- æ–°å¢çš„æ›¸ç±æ¨è–¦å€å¡Šæ¨£å¼ --- */
    .books-recommendation-section {
        flex-shrink: 0; /* é˜²æ­¢æ›¸ç±å€å¡Šè¢«å£“ç¸® */
        width: 30%; /* è¨­å®šæ›¸ç±å€å¡Šçš„å¯¬åº¦ */
        max-width: 300px; /* é™åˆ¶æ›¸ç±å€å¡Šæœ€å¤§å¯¬åº¦ */
        display: flex;
        flex-direction: column;
        align-items: center; /* å±…ä¸­æ›¸ç±åˆ—è¡¨ */
        box-sizing: border-box;
        padding-left: 20px; /* èˆ‡å·¦å´æ–‡å­—å€å¡Šçš„é–“éš” */
    }
    .books-recommendation-section h3 {
        color: rgb(163, 20, 20);
        font-size: 1.1em;
        margin-bottom: 15px;
        border-bottom: 2px solid #87ceeb;
        padding-bottom: 8px;
        width: 100%; /* æ¨™é¡Œå¯¬åº¦ä½”æ»¿ */
        text-align: center; /* æ¨™é¡Œå±…ä¸­ */
    }
    .recommended-books {
        display: flex;
        flex-wrap: wrap; /* å…è¨±æ›è¡Œ */
        gap: 15px; /* æ›¸ç±ä¹‹é–“çš„é–“éš” */
        margin-top: 0; /* ç§»é™¤åŸæœ‰çš„ margin-top */
        padding-top: 0; /* ç§»é™¤åŸæœ‰çš„ padding-top */
        border-top: none; /* ç§»é™¤åŸæœ‰çš„ border-top */
        opacity: 0; /* åˆå§‹éš±è—ï¼Œå¾…å‹•ç•«å‡ºç¾ */
        transform: translateY(10px); /* åˆå§‹ä½ç§» */
        transition: opacity 0.8s, transform 0.8s;
        width: 100%; /* ä½”æ»¿å®¹å™¨å¯¬åº¦ */
        justify-content: center; /* å…§å®¹å±…ä¸­ */
    }
    .recommended-books.visible { /* è®“æ–‡å­—èªªæ˜ä¹Ÿä¸€èµ·æ·¡å…¥ */
        opacity: 1;
        transform: translateY(0);
    }
    .book-item {
        display: flex;
        flex-direction: column; /* ç›´å‘æ’åˆ— */
        align-items: center; /* å±…ä¸­ */
        width: 100px; /* æ›¸ç±å€å¡Šå¯¬åº¦ */
        text-align: center;
    }
    .book-cover-container {
        width: 100px; /* æ›¸ç±å°é¢åœ–å¯¬åº¦ */
        height: 140px; /* æ›¸ç±å°é¢åœ–é«˜åº¦ */
        background-color: rgba(255, 255, 255, 0.15); /* å°é¢å€å¡ŠèƒŒæ™¯ */
        border-radius: 6px;
        margin-bottom: 8px;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden; /* ç¢ºä¿åœ–ç‰‡ä¸æœƒè¶…å‡ºé‚Šç•Œ */
        border: 1px solid rgba(255,255,255,0.1);
        transition: transform 0.3s cubic-bezier(.2,1.8,.6,1), box-shadow 0.2s;
        cursor: pointer; /* æç¤ºå¯é»æ“Š */
    }
    .book-cover-container:hover {
        transform: scale(1.1);
        box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }
    .book-cover {
        width: 90%; /* å°é¢åœ–å¯¦éš›é¡¯ç¤ºæ¯”ä¾‹ */
        height: 90%;
        object-fit: cover; /* ç¢ºä¿åœ–ç‰‡å¡«å……ä¸”ä¸è®Šå½¢ */
        border-radius: 3px; /* å°é¢åœ–é‚Šè§’ */
    }
    .book-title {
        font-size: 0.9em;
        color: #0e4c81; /* ç™½è‰² */
        font-weight: bold;
        margin-bottom: 4px;
        line-height: 1.3;
    }
    .book-author {
        font-size: 0.8em;
        color: #10043a; /* æ·ºç°è‰² */
        font-style: italic;
    }

    /* --- å³ä¸‹æ–¹å¯¦éš›æ¡ˆä¾‹æŒ‰éˆ• --- */
    #show-case-btn {
        position: fixed;
        right: 30px;
        bottom: 30px;
        z-index: 120;
        background: #ffd700;
        color: #005a9c;
        border-radius: 8px;
        font-weight: bold;
        padding: 12px 25px;
        box-shadow: 0 3px 10px rgba(150,150,30,0.09);
        border: none;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.2s;
        opacity: 1;
        display: none; /* åˆå§‹éš±è— */
    }
    #show-case-btn:hover {
        background: #ffec76;
        transform: scale(1.08);
    }
    /* --- æ¡ˆä¾‹é é¢ç¾åŒ–+æ’åœ–æ”¾å¤§ --- */
    #case-panel {
        background: linear-gradient(120deg, #d8ffd8 0%, #c1ffc1 100%);
        backdrop-filter: blur(6px);
        border: 1.5px solid rgba(255,255,255,0.3);
        box-shadow: 0 10px 38px 10px rgba(20, 40, 49, 0.16), 0 3px 12px rgba(69, 69, 139, 0.19);
        color: #005a9c;
        border-radius: 18px;
        position: absolute;
        top: 50%; left: 50%; transform: translate(-50%,-50%);
        width: 88%; max-width: 680px;
        display:none; flex-direction:column; align-items:center;
        padding: 40px 28px 25px 28px; z-index: 520;
        animation: fadeInCase 0.9s;
    }
    @keyframes fadeInCase { 0%{opacity:0; transform: scale(0.92) translate(-50%,-55%);}
                            90%{opacity:1; transform: scale(1.03) translate(-50%,-48%);}
                           100%{opacity:1; transform: scale(1) translate(-50%,-50%);}
    }
    #case-panel h3, #case-panel ul { background: transparent; }
    #case-panel .case-image-box{
        width:200px; height:150px;
        background:rgba(250,250,255,0.10);
        border-radius:14px;
        display:flex; justify-content:center; align-items:center;
        margin-bottom:15px; overflow:hidden;
        box-shadow:0 2px 12px rgba(50,160,235,0.14);
        border:2.5px solid rgba(255,255,255,0.21);
        backdrop-filter: blur(3px);
        transition: box-shadow 0.37s;
    }
    #case-img {
        width: 100%; height: 100%;
        object-fit:cover; border-radius:13px;
        transition: transform 0.37s cubic-bezier(.2,1.3,.48,1.29), box-shadow 0.27s, filter 0.19s;
        cursor: zoom-in;
    }
    #case-img:hover, #case-img:focus {
        transform: scale(1.6) translateY(-20px);
        z-index: 99;
        box-shadow: 0 16px 50px #009fd6ab, 0 2px 16px #3498db50;
        filter: brightness(1.12) saturate(1.25);
        outline: none;
    }
    #case-img:active {
        transform: scale(1.85) translateY(-32px);
        filter: brightness(1.19) saturate(1.33);
    }
    @media (hover: none) {
      #case-img:active {
        transform: scale(1.53) translateY(-8px);
      }
    }
    @media(max-width:700px){
        #case-panel{padding:15px 2vw 10px 2vw; width:98vw; }
        #case-panel .case-image-box{width:98px; height:70px;}
        #show-case-btn{right:10px; bottom:10px; font-size:15px; padding:8px 15px;}
    }
    #case-panel h3{margin-bottom:10px;}
    #case-panel ul{margin:12px 0 0 0; padding-left:18px;}
    #case-panel button{
        margin-top:28px; background:#28a745; color:white; font-weight:bold; padding:10px 22px;
        border:none; border-radius:8px; cursor:pointer; font-size:16px; box-shadow:0 2px 8px #87ceeb;
    }
    #case-panel button:hover{ background: #218838;}
    
    /* -----ä»¥ä¸‹åŸæœ‰CSS---- */
    #summary-panel {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,40,80,0.85); color: white; display: none; flex-direction: column;
        align-items: center; justify-content: center; opacity: 0; transition: opacity 1s; z-index: 30;
    }
    #summary-panel h2 { font-size: 2.5em; margin-bottom: 30px;}
    .summary-content { display: flex; justify-content: space-around; width: 90%;}
    .summary-column { width: 30%; padding: 0 15px;}
    .summary-column h3 { color: #87ceeb; border-bottom: 2px solid #87ceeb; padding-bottom: 10px;}
    .summary-column ul { list-style: none; padding: 0;}
    .summary-column li { margin: 10px 0; font-size: 0.9em;}
    #core-principles-panel {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 55%, #87ceeb 100%);
        color: white; display: none; flex-direction: column; align-items: center; justify-content: center;
        opacity: 0; transition: opacity 1s; z-index: 35; text-align: center;
        padding-top: 10px; 
        padding-bottom: 56px;
    }
    .core-principles-content {
        width: 850px; max-width: 98vw;
        margin-top: 0; margin-bottom: 0;
        display: flex; flex-direction: column; align-items: stretch;
        gap: 18px;
    }
    .principle-item {
        width: 100%;
        box-sizing: border-box;
        background: rgba(255,255,255,0.11);
        border-radius: 8px; border-left: 3px solid #87ceeb;
        margin: 0;
        padding: 12px 16px;
        display: flex;
        flex-direction: row;
        align-items: center;     
        justify-content: flex-start;
        opacity: 0; transform: translateY(24px); transition: opacity 0.8s, transform 0.8s;
        position: relative;
        overflow: visible;
        z-index: 1;
    }
    .principle-img,
    .example-image-float {
        cursor: pointer;
        transition: transform 0.25s cubic-bezier(.2,1.8,.6,1), box-shadow 0.2s, filter 0.2s;
        z-index: 2;
    }
    .principle-img {
        margin-right: 25px; margin-left: 0; 
        width: 48px; height: 48px; object-fit: contain;
        border-radius: 10px; background: #eaf6fd; box-shadow: 0 2px 10px rgba(0,0,0,0.09);
        border: 1px solid #cce2ee; display: block; flex-shrink: 0;
    }
    .example-image-float {
        width: 100%; height: 100%;
        object-fit: cover;
        border-radius: 10px;
        border: none;
        background: transparent;
        display: block;
        min-width: 0;
    }
    .principle-img:hover,
    .principle-img:focus,
    .principle-img:active,
    .example-image-float:hover,
    .example-image-float:focus,
    .example-image-float:active {
        transform: scale(1.8) translateY(-10px);
        z-index: 40;
        box-shadow: 0 12px 36px rgba(30,60,150,0.24), 0 2px 16px #87ceeb;
        filter: brightness(1.09) saturate(1.28);
        outline: none;
    }
    .principle-img:active,
    .example-image-float:active {
        transform: scale(2.0) translateY(-16px);
        filter: brightness(1.14) saturate(1.42);
    }
    .principle-img:focus,
    .example-image-float:focus {
        outline: 2.5px solid #87ceeb;
    }
    .principle-text-content {
        display: flex; flex-direction: column; justify-content: center;
        align-items: flex-start;    
        min-width: 0;
    }
    .principle-text-content h3 {
        margin: 0 0 9px 0;
        font-size: 1.15em;
        font-weight: bold;
    }
    .principle-text-content p {
        font-size: 1em; color: white; font-weight: 500;
        margin: 0; text-align: left;
    }
    .final-message {
        min-height: 48px; 
        display: flex; align-items: center; justify-content: center; cursor: pointer;
        min-width: 180px; max-width: 100%; box-sizing: border-box;
        padding: 13px 18px;
        background: rgba(255,255,255,0.16);
        border-radius: 10px; border: 2px solid #87ceeb;
        opacity: 0; transform: scale(0.92); transition: opacity 1s, transform 1s;
    }
    .final-message:hover { background: rgba(255,255,255,0.27); transform: scale(1.04);}
    .final-message h3 { font-size: 1.4em; color: #f0f8ff; margin: 0; }
    @media (max-width: 700px) {
        .core-principles-content { width: 99vw; gap: 10px; }
        .principle-item { flex-direction: column; align-items: center; justify-content: center; padding: 8px 4px; }
        .principle-img { margin: 0 0 8px 0; width: 36px; height: 36px; }
        .final-message { min-width: 130px; }
    }
    #example-share-btn {
        margin-top: 30px; padding: 12px 25px; font-size: 16px; font-weight: bold; color: #005a9c; background: #add8e6;
        border: 1px solid #005a9c; border-radius: 8px; cursor: pointer; transition: background-color 0.3s, transform 0.2s;
    }
    #example-share-btn:hover:not(:disabled) { background: #87ceeb; transform: scale(1.05);}
    #example-modal {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,40,80,0.9);
        display: none; justify-content: center; align-items: center; z-index: 1000; opacity: 0; transition: opacity 0.5s;
    }
    #example-modal.visible { display: flex; opacity: 1;}
    #example-content {
        background: rgba(255,255,255,0.95); padding: 30px; border-radius: 15px; width: 85%; max-width: 960px; max-height: 85vh; overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.4); color: #333;
    }
    #example-content h2 { text-align: center; color: #87ceeb; margin-top: 0; font-size: 2.2em; border-bottom: 2px solid #87ceeb; padding-bottom: 15px; margin-bottom: 25px;}
    .example-section { margin-bottom: 30px; display: flex; align-items: flex-start; gap: 20px;}
    .example-image-placeholder {
        flex-shrink: 0;
        width: 180px; height: 150px;
        background: #e0e0e0; border-radius: 10px;
        display: flex; justify-content: center; align-items: center;
        font-size: 0.9em; color: #666; text-align: center;
        border: 2px dashed #ccc;
        overflow: hidden;
    }
    .example-section#takeoff-example .example-image-placeholder { background: #cce5ff; border-color: #b3d7ff;}
    .example-section#cruising-example .example-image-placeholder { background: #d4edda; border-color: #c3e6cb;}
    .example-section#landing-example .example-image-placeholder { background: #fff3cd; border-color: #ffeeba;}
    .example-image-placeholder {
        position: relative;
        overflow: visible;
        z-index: 10;
    }
    .example-image-float {
        width: 100%;
        height: 100%;
        transition: transform 0.37s cubic-bezier(.2,1.3,.48,1.29), box-shadow 0.27s, filter 0.19s;
        cursor: zoom-in;
    }
    .example-image-float:hover, .example-image-float:focus {
        transform: scale(1.6) translateY(-20px);
        z-index: 99;
        box-shadow: 0 16px 50px #009fd6ab, 0 2px 16px #3498db50;
        filter: brightness(1.12) saturate(1.25);
        outline: none;
    }
    .example-image-float:active {
        transform: scale(1.85) translateY(-32px);
        filter: brightness(1.19) saturate(1.33);
    }
    @media (hover: none) {
      .example-image-float:active {
        transform: scale(1.53) translateY(-8px);
      }
    }
    .example-text-content { flex-grow: 1;}
    .example-text-content h3 { color: #28a745; margin-bottom: 15px; font-size: 1.4em; padding-left: 10px; border-left: 4px solid #28a745;}
    .example-text-content ul { list-style: disc; padding-left: 30px;}
    .example-text-content li { margin-bottom: 12px; font-size: 1.05em; line-height: 1.6;}
    #close-example-modal {
        display: block; margin: 30px auto 0; padding: 12px 25px; font-size: 16px; font-weight: bold; color: white;
        background: #dc3545; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s, transform 0.2s;
    }
    #close-example-modal:hover { background: #c82333; transform: scale(1.05);}
    #start-btn {
        position: absolute; top: 20px; left: 20px; padding: 12px 25px; font-size: 16px; font-weight: bold; color: white;
        background: #28a745; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s; z-index: 40;
    }
    #start-btn:hover:not(:disabled) { background: #218838; transform: scale(1.05);}
    #start-btn:disabled { background: #6c757d; cursor: not-allowed;}
    @keyframes pulse-glow { 0% { box-shadow: 0 0 5px #34c759,0 0 10px #34c759;} 50%{ box-shadow: 0 0 20px #34c759,0 0 30px #34c759;} 100%{ box-shadow: 0 0 5px #34c759,0 0 10px #34c759;} }
    .waiting-for-input { animation: pulse-glow 2s infinite;}
</style>
</head>
<body>
<!-- å°é¢é  -->
<div id="cover-page">
    <h1>ä¸»ç®¡ç®¡ç†å¿ƒå¾—åˆ†äº«</h1>
    <p class="info">å ±å‘Šäºº: é™³é´»æ³°</p>
    <p class="info">å ±å‘Šæ—¥æœŸ: 2026/03/17</p>
    <button id="enter-btn">é€²å…¥åˆ†äº«æœƒ</button>
</div>
<div id="flight-container">
    <button id="start-btn" class="waiting-for-input" style="display:none;">ğŸš€ å•Ÿå‹•é³³å‡°è¨ˆç•«</button>
    <canvas id="path-canvas"></canvas>
    <div id="airplane">
        <img src="bird.gif" alt="airplane animation" width="95" height="95">
    </div>
    
    <!-- è³‡è¨Šé¢æ¿ (åŒ…å«å·¦å³å…©å€å¡Š) -->
    <div id="info-panel">
        <div class="info-content-left">
            <h2 id="info-title"></h2>
            <p id="info-subtitle"></p>
            <ul id="info-points"></ul>
        </div>
        <div class="books-recommendation-section">
            <!-- æ›¸ç±æ¨è–¦å€å¡Šå°‡ç”± JS å‹•æ…‹æ’å…¥ -->
            <h3 id="books-recommendation-title"></h3>
            <div id="books-container"></div> <!-- ç”¨ä¾†æ”¾ç½®æ›¸ç±åˆ—è¡¨ -->
        </div>
    </div>

    <!-- å³ä¸‹æ–¹å¯¦éš›æ¡ˆä¾‹æŒ‰éˆ• -->
    <button id="show-case-btn">ğŸ” å¯¦éš›æ¡ˆä¾‹</button>
    <!-- æ¡ˆä¾‹ç»ç’ƒé¢æ¿ -->
    <div id="case-panel">
        <div class="case-image-box"><img src="" id="case-img" alt="æ¡ˆä¾‹åœ–ç‰‡"></div>
        <h3 id="case-title"></h3>
        <ul id="case-points"></ul>
        <button id="close-case-btn">è¿”å›</button>
    </div>
    <!-- Summaryã€å¿ƒæ³•é¢æ¿ï¼ˆåŸæœ¬å…§å®¹ï¼‰ -->
    <div id="summary-panel">
        <h2>é³³å‡°é£›è¡Œè¨ˆç•«ç¸½çµ</h2>
        <div class="summary-content">
            <div class="summary-column" id="summary-takeoff"></div>
            <div class="summary-column" id="summary-cruising"></div>
            <div class="summary-column" id="summary-landing"></div>
        </div>
        <button id="example-share-btn">ğŸ’¡ å¯¦ä¾‹åˆ†äº«</button>
    </div>
    <!-- æ ¸å¿ƒå¿ƒæ³•é¢æ¿ -->
    <div id="core-principles-panel">
        <div class="core-principles-content">
            <div class="principle-item" id="principle-takeoff">
                <img src="climb.png" alt="èµ·é£›éšæ®µæ’åœ–" class="principle-img" tabindex="0" />
                <div class="principle-text-content">
                    <h3>ğŸ›« é–‹å‰µæœŸ : ç†±æƒ…+æ–¹å‘ &rarr; å‹‡æ°£</h3>
                    <p>èº«å…ˆå£«å’, ä»¥çµ‚ç‚ºå§‹, æ˜ç¢ºæŒ‡ä»¤, åŒ…å®¹éŒ¯èª¤</p>
                </div>
            </div>
            <div class="principle-item" id="principle-cruising">
                <img src="rule.png" alt="å¹³ç©©éšæ®µæ’åœ–" class="principle-img" tabindex="0" />
                <div class="principle-text-content">
                    <h3>âœˆï¸ ç¶­é‹æœŸ: åˆ¶åº¦+æ•ˆç‡ &rarr; ç´€å¾‹</h3>
                    <p>æ•¸æ“šç®¡ç†, å»ºç«‹åˆ¶åº¦, é—œæ³¨ç•°å¸¸, åŸ¹è‚²äººæ‰</p>
                </div>
            </div>
            <div class="principle-item" id="principle-landing">
                <img src="transform.png" alt="ä¸‹é™éšæ®µæ’åœ–" class="principle-img" tabindex="0" />
                <div class="principle-text-content">
                    <h3>ğŸ›¬ è½‰å‹æœŸ: å…±è­˜+è®Šé© &rarr; é¡˜æ™¯</h3>
                    <p>å¿ƒæ…‹èª¿é©, ææ—©å°æ‡‰, å¤šæ–¹å˜—è©¦, ä¸å±ˆä¸æ’“</p>
                </div>
            </div>
            <div class="final-message">
                <h3>èƒ½ç‚ºçµ„ç¹”ç•™ä¸‹ç”šéº¼</h3>
            </div>
        </div>
    </div>
</div>
<!-- å¯¦ä¾‹åˆ†äº«çš„ Modal å½ˆçª— (åŸæœ¬å…§å®¹) -->
<div id="example-modal">
    <div id="example-content">
        <h2>ç®¡ç†å¯¦ä¾‹åˆ†äº«</h2>
        <div class="example-section" id="takeoff-example">
            <div class="example-image-placeholder">
                <img src="pic-a.png" alt="èµ·é£›éšæ®µç¯„ä¾‹åœ–" class="example-image-float" tabindex="0">
            </div>
            <div class="example-text-content">
                <h3>ğŸ›« èµ·é£›éšæ®µäº‹ä¾‹: å”åŠ©å‰µå»ºATåœ˜éšŠè½„ä¸‹å…‰å­¸éƒ¨é–€</h3>
                <ul>
                    <li> å…¬å¸æˆç«‹ATåœ˜éšŠ, å”åŠ©å»ºç«‹è‡ªå‹•åŒ–æ‰€éœ€å…‰å­¸åœ˜éšŠ</li>
                    <li> è‰å‰µéšæ®µ,èº«å…ˆå£«å’, å°‡å£«ç”¨å‘½, æ“¬å®šæ©Ÿå°å°ä½ç³»çµ±åŠRule-basedçš„AOIæª¢æ¸¬ç™¼å±•é‡å¿ƒ</li>
                    <li> æˆåŠŸæ–¼å—äº¬æ¨¡çµ„å» ä¸Šç·šOCAè²¼åˆç³»çµ±, ä¸Šæµ·MOD ACFå£“ç—•æª¢æ¸¬ç³»çµ±, å°å—MODå…¨è‡ªå‹•P-line</li>
                    <li> é–‹ç™¼å½±åƒé¡å°ˆç”¨:*å°ä½å‡½å¼åº«, *AOIç¼ºé™·è¾¨è­˜ç³»çµ±, *APIé¢æ¿åˆ¤å®šç³»çµ±</li>
                    <li> è¡ç”Ÿæˆç«‹CIM AIå°çµ„, å°ˆæ³¨å½±åƒé¡AI ç™¼å±• (ADJ, ADR, HOP)</li>
                </ul>
            </div>
        </div>
        <div class="example-section" id="cruising-example">
            <div class="example-image-placeholder">
                <img src="pic-b.png" alt="é£›è¡Œéšæ®µç¯„ä¾‹åœ–" class="example-image-float" tabindex="0">
            </div>
            <div class="example-text-content">
                <h3>âœˆï¸ ç©©å®šé£›è¡Œéšæ®µäº‹ä¾‹: <a href="http://tnecim.cminl.oa/" target="_blank">eCIM å…§éƒ¨ç®¡ç†ç³»çµ±</a></h3>
                <ul>
                    <li> éœ€æ±‚å–®ç³»çµ±(ç°½æ ¸,æ•ˆç›Š,å ±è¡¨)</li>
                    <li> äººå“¡å·¥æ™‚åŠå·¥ä½œç´€éŒ„åŠé€±æœƒReviewæ©Ÿåˆ¶</li>
                    <li> å€¼ç­Call In,Call Out, Issueç´€éŒ„, Reviewç³»çµ±</li>
                    <li> ç³»çµ±è»Ÿç¡¬é«”è‡ªæˆ‘ç›£æ§åŠé€šå ±ç³»çµ±</li>
                    <li> ç¨‹å¼ç®¡ç†,è‡ªå‹•ä½ˆç½²,ç™¼è¡Œç®¡ç†,å½±éŸ³è¨“ç·´èª²ç¨‹</li>
                </ul>
            </div>
        </div>
        <div class="example-section" id="landing-example">
            <div class="example-image-placeholder">
                <img src="pic-c.png" alt="é™è½éšæ®µç¯„ä¾‹åœ–" class="example-image-float" tabindex="0">
            </div>
            <div class="example-text-content">
                <h3>ğŸ›¬ é™è½éšæ®µäº‹ä¾‹: FAB1,2é—œå» ->PLPå…¨è‡ªè£½CIMç³»çµ± </h3>
                <ul>
                    <li> å¸‚é¢ä¸Šä¸¦ç„¡é©ç”¨æ–¼å¯æ”¯æ´Wafer, Panel, QPanel, Dieè¿½è¹¤çš„å°è£åŠæ¸¬è©¦æ¥­MESç³»çµ±</li>
                    <li> æ’¤æ£„é —è²´çš„IBM LCDViewæ¶æ§‹,ç›´æ¥æ¸›å°‘license è²»ç”¨ç´„5åƒè¬/3å¥—</li>
                    <li> æ¡ç”¨x86é–‹æ”¾æ¶æ§‹, ä½¿ç”¨C#é–‹ç™¼, ä¸¦ä»¥æ¨™æº–APIä½œç‚ºå„ç³»çµ±é–“æ¨™æº–ä»‹é¢</li>
                    <li> é‡å°åŠå°é«”å¾Œæ®µå„è¨­å‚™é©ç”¨çš„SECS GEMè¦ç¯„é–‹ç™¼ç‰¹å®šEAPç³»çµ±</li>
                    <li> å¯æ•´åˆåŸæœ¬å…¬å¸çš„å‘¨é‚Šç³»çµ± (ç•°å¸¸å–®,æ©Ÿå°æ¨æ’­,EDC-x,EDC-h,iPM...)</li>
                </ul>
            </div>
        </div>
        <button id="close-example-modal">é—œé–‰</button>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
    // --- åŸºæœ¬å®£å‘Š ---
    const coverPage = document.getElementById('cover-page');
    const enterButton = document.getElementById('enter-btn');
    const flightContainer = document.getElementById('flight-container');
    const startBtn = document.getElementById('start-btn');
    const airplane = document.getElementById('airplane');
    const infoPanel = document.getElementById('info-panel');
    const infoTitle = document.getElementById('info-title');
    const infoSubtitle = document.getElementById('info-subtitle');
    const infoPoints = document.getElementById('info-points');
    const booksRecommendationTitle = document.getElementById('books-recommendation-title'); // æ–°å¢çš„æ¨™é¡Œå…ƒç´ 
    const booksContainer = document.getElementById('books-container'); // æ–°å¢çš„å®¹å™¨å…ƒç´ 
    const showCaseBtn = document.getElementById('show-case-btn');
    const casePanel = document.getElementById('case-panel');
    const caseImg = document.getElementById('case-img');
    const caseTitle = document.getElementById('case-title');
    const casePoints = document.getElementById('case-points');
    const closeCaseBtn = document.getElementById('close-case-btn');
    const canvas = document.getElementById('path-canvas');
    const ctx = canvas.getContext('2d');
    const summaryPanel = document.getElementById('summary-panel');
    const corePrinciplesPanel = document.getElementById('core-principles-panel');
    // å¯¦ä¾‹åˆ†äº« Modal
    const exampleShareBtn = document.getElementById('example-share-btn');
    const exampleModal = document.getElementById('example-modal');
    const closeExampleModalBtn = document.getElementById('close-example-modal');

    // --- é£›è¡Œéšæ®µè³‡æ–™ ---
    // !!! è«‹åœ¨é€™è£¡ä¿®æ”¹æˆ–æ›¿æ›æ‚¨çš„æ›¸ç±åœ–ç‰‡æª”åã€æ›¸åå’Œä½œè€… !!!
    const flightData = {
        takeoff: {
            title: "ğŸ›« èµ·é£›éšæ®µ (é–‹å‰µæœŸ): æ•¢è¡",
            subtitle: "çµ¦æ–¹å‘ã€çµ¦è³‡æºã€çµ¦ç©ºé–“ï¼Œä¸€èµ·æŠŠé£›æ©Ÿæ¨ä¸Šå¤©ï¼",
            points: [
                "(a) æ“¬å®šæ¸…æ™°é¡˜æ™¯åŠç›®æ¨™, ä»¥çµ‚ç‚ºå§‹ ğŸ¯",
                "(b) èº«å…ˆå£«å’, é ˜å°åœ˜éšŠ ğŸ‘¨â€ğŸ«",
                "(c) æä¾›å……è¶³è³‡æº â›½",
                "(d) è³¦äºˆåœ˜éšŠè¼ƒå¤§å½ˆæ€§ ğŸ¤¸",
                "(e) å¿«é€Ÿåæ‡‰, ç²¾æº–æ±ºç­– ğŸ™"
            ],
            caseId: "takeoff-example",
            books: [ // <<< èµ·é£›éšæ®µæ¨è–¦æ›¸ç±
                {
                    cover: "book1-1.jpg", // è«‹æ›¿æ›æˆæ‚¨çš„åœ–ç‰‡æª”å
                    title: "ã€Šå¾0åˆ°1ã€‹",
                    author: "å½¼å¾—â€¢è’‚çˆ¾"
                },
                {
                    cover: "book1-2.jpg", // è«‹æ›¿æ›æˆæ‚¨çš„åœ–ç‰‡æª”å
                    title: "ã€Šç²¾å¯¦å‰µæ¥­ã€‹",
                    author: "åŸƒé‡Œå…‹Â·èŠæ–¯"
                }
            ]
        },
        cruising: {
            title: "âœˆï¸ å¹³ç©©é£›è¡Œéšæ®µ (ç¶­é‹æœŸ): æœƒç©© ",
            subtitle: "è‡ªå‹•é§•é§›å•Ÿå‹•ï¼ç¾åœ¨è¦çœ‹çš„æ˜¯å„€è¡¨æ¿ï¼Œä¸æ˜¯çª—å¤–çš„é¢¨æ™¯ã€‚",
            points: [
                "(a) ç®¡ç†æ•¸æ“šæ”¶é›† ğŸ“Š",
                "(b) å»ºç«‹æ•¸æ“š KPI ğŸ“ˆ",
                "(c) å°å…¥ç³»çµ±åŒ–ç®¡ç† âš™ï¸",
                "(d) å½¢æˆç®¡ç†é–‰ç’° ğŸ”„"
            ],
            caseId: "cruising-example",
            books: [ // <<< å¹³ç©©é£›è¡Œéšæ®µæ¨è–¦æ›¸ç±
                {
                    cover: "book2-1.jpg",
                    title: "ã€Šè±ç”°æ¨¡å¼,æ‰“é€ ä¸–ç•Œç´šä¼æ¥­ã€‹",
                    author: "å‚‘å¼—ç‘.èŠå…‹"
                },
                {
                    cover: "book2-2.jpg",
                    title: "ã€Šå¾Aåˆ°A+,Good to Greatã€‹",
                    author: "å‰å§†.æŸ¯æ—æ–¯"
                }
            ]
        },
        landing: {
            title: "ğŸ›¬ é™è½éšæ®µ (è½‰å‹æœŸ): èƒ½è®Š",
            subtitle: "å®‰å…¨è‘—é™¸æ˜¯ç¬¬ä¸€è¦å‹™ï¼ŒåŒæ™‚ä¹Ÿè¦æƒ³å¥½é£›æ©Ÿè½åœ°å¾Œè¦åšä»€éº¼ã€‚",
            points: [
                "(a) èª¿æ•´å¿ƒæ…‹, å‡èšå…±è­˜ ğŸ› ï¸",
                "(b) æŠ€è¡“ç›¤é», æ‰¾å°‹æ©Ÿæœƒ ğŸ“š",
                "(c) åœ˜éšŠæå‡, çµ„ç¹”å†é€  ğŸ§‘â€âœˆï¸",
                "(d) æ“¬å®šè¨ˆç•«, ç©©å®šå‰è¡Œ ğŸ—ºï¸"
            ],
            caseId: "landing-example",
            books: [ // <<< é™è½éšæ®µæ¨è–¦æ›¸ç±
                {
                    cover: "book3-1.jpg",
                    title: "ã€Šé ˜å°äººçš„è®Šé©æ³•å‰‡ã€‹",
                    author: "ç§‘æ©"
                },
                {
                    cover: "book3-2.jpg",
                    title: "ã€ŠåŸä¾†ä½ æ‰æ˜¯çµ†è…³çŸ³ã€‹",
                    author: "Jutta & John"
                }
            ]
        }
    };

    let flightState = 'idle'; // 'idle', 'animating', 'takeoff_complete', 'cruising_complete', 'landing_complete', 'summary_displayed', 'core_principles_displayed'
    const ANIMATION_DURATION = 6000;
    let currentPhaseForCase = null; // è¨˜éŒ„ç›®å‰é¡¯ç¤ºçš„éšæ®µï¼Œæ–¹ä¾¿æ¡ˆä¾‹æŒ‰éˆ•ä½¿ç”¨

    // --- å‡½æ•¸å®šç¾© ---

    // ç¹ªè£½é£›è¡Œè·¯å¾‘
    function drawFlightPath() {
        const width = flightContainer.clientWidth;
        const height = flightContainer.clientHeight;
        canvas.width = width;
        canvas.height = height;
        ctx.clearRect(0, 0, width, height);
        ctx.strokeStyle = '#FFFFFF';
        ctx.lineWidth = 3;
        ctx.setLineDash([5, 10]);
        ctx.globalAlpha = 0.8;
        const p1 = { x: width * -0.10, y: height * 0.95 }; // èµ·é» (å·¦ä¸‹æ–¹å¤–)
        const p2 = { x: width * 0.45, y: height * 0.3 }; // çˆ¬å‡åˆ°æœ€é«˜é»
        const p3 = { x: width * 0.80, y: height * 0.3 }; // é«˜é»è½‰æŠ˜
        const p4 = { x: width * 1.20, y: height * 0.95 }; // çµ‚é» (å³ä¸‹æ–¹å¤–)

        ctx.beginPath();
        ctx.moveTo(p1.x, p1.y);
        ctx.quadraticCurveTo(width * 0.20, height * 0.95, p2.x, p2.y); // ç¹ªè£½èµ·é£›æ›²ç·š
        ctx.lineTo(p3.x, p3.y); // ç¹ªè£½å¹³ç©©é£›è¡Œç·šæ®µ
        ctx.quadraticCurveTo(width * 0.80, height * 0.50, p4.x, p4.y); // ç¹ªè£½é™è½æ›²ç·š
        ctx.stroke();
    }

    // æ›´æ–°è³‡è¨Šé¢æ¿å…§å®¹ï¼ŒåŒ…å«æ›¸ç±å€å¡Š
    function updateInfoPanel(phase) {
        const data = flightData[phase];
        infoTitle.textContent = data.title;
        infoSubtitle.textContent = data.subtitle;
        infoPoints.innerHTML = ''; // æ¸…ç©ºèˆŠçš„é‡é»
        
        // æ¸…ç©ºèˆŠçš„æ›¸ç±å€å¡Š (æ¨™é¡Œå’Œåˆ—è¡¨)
        booksRecommendationTitle.textContent = '';
        booksContainer.innerHTML = '';
        const existingBooksContainer = infoPanel.querySelector('.recommended-books');
        if (existingBooksContainer) {
            existingBooksContainer.remove();
        }

        infoPanel.style.opacity = '1'; // ç¢ºä¿é¢æ¿å¯è¦‹
        showCaseBtn.style.display = 'none'; // æš«æ™‚éš±è—æ¡ˆä¾‹æŒ‰éˆ•ï¼Œå¾…è³‡è¨Šè¼‰å…¥å®Œå†é¡¯ç¤º
        
        let finishedPointsCount = 0; // è¨ˆç®—å·²é¡¯ç¤ºçš„é‡é»æ•¸é‡

        // å‹•æ…‹è¼‰å…¥é‡é»æ¢åˆ—
        data.points.forEach((point, idx) => {
            setTimeout(() => {
                const li = document.createElement('li');
                li.innerHTML = point; // ä½¿ç”¨ innerHTML å…è¨± HTML æ¨™ç±¤ (å¦‚ emoji)
                infoPoints.appendChild(li);
                // æ·¡å…¥å‹•ç•«
                setTimeout(() => {
                    li.style.opacity = '1';
                    li.style.transform = 'translateY(0)';
                    finishedPointsCount++;
                    // ç•¶æ‰€æœ‰é‡é»éƒ½é¡¯ç¤ºå®Œç•¢å¾Œï¼Œè™•ç†æ›¸ç±å€å¡Š
                    if (finishedPointsCount === data.points.length) {
                        if (data.books && data.books.length > 0) {
                            renderBooks(data.books); // æ¸²æŸ“æ›¸ç±
                        } else {
                            // å¦‚æœæ²’æœ‰æ›¸ç±ï¼Œä¹Ÿæ‡‰è©²ç¢ºä¿å¾ŒçºŒé‚è¼¯ (é¡¯ç¤ºæ¡ˆä¾‹æŒ‰éˆ•) èƒ½è¢«è§¸ç™¼
                            showCaseBtn.style.display = 'inline-block';
                            showCaseBtn.style.opacity = '1';
                        }
                    }
                }, 50); // æ¯å€‹ li çš„æ·¡å…¥å‹•ç•«å»¶é²
            }, idx * 500); // æ¯å€‹ li å‡ºç¾ä¹‹é–“çš„å‹•ç•«å»¶é²
        });
        
        currentPhaseForCase = phase; // æ›´æ–°ç•¶å‰éšæ®µï¼Œä¾›æ¡ˆä¾‹æŒ‰éˆ•èª¿ç”¨
    }

    // æ¸²æŸ“æ›¸ç±æ¨è–¦å€å¡Š
    function renderBooks(booksData) {
        // è¨­ç½®æ›¸ç±æ¨è–¦æ¨™é¡Œ
        booksRecommendationTitle.textContent = 'ğŸ“š æ¨è–¦é–±è®€';
        
        const booksListWrapper = document.createElement('div');
        booksListWrapper.className = 'recommended-books';

        booksData.forEach(book => {
            const bookItem = document.createElement('div');
            bookItem.className = 'book-item';

            const coverContainer = document.createElement('div');
            coverContainer.className = 'book-cover-container';
            // å¯ä»¥ç‚ºå°é¢åœ–æ·»åŠ é»æ“Šäº‹ä»¶ï¼Œä¾‹å¦‚æ”¾å¤§é¡¯ç¤º
            coverContainer.onclick = function() {
                console.log(`Clicked on book: ${book.title}`);
                // åœ¨é€™è£¡å¯ä»¥å¯¦ç¾åœ–ç‰‡æ”¾å¤§ã€å½ˆçª—é¡¯ç¤ºæ›´å¤šè³‡è¨Šç­‰åŠŸèƒ½
                // ä¾‹å¦‚: alert(`ä½ é»æ“Šäº†ï¼šã€Š${book.title}ã€‹by ${book.author}`);
            };

            const coverImg = document.createElement('img');
            coverImg.src = book.cover;
            coverImg.alt = `ã€Š${book.title}ã€‹å°é¢`;
            coverImg.className = 'book-cover';

            const titleEl = document.createElement('div');
            titleEl.className = 'book-title';
            titleEl.textContent = book.title;

            const authorEl = document.createElement('div');
            authorEl.className = 'book-author';
            authorEl.textContent = book.author;

            coverContainer.appendChild(coverImg);
            bookItem.appendChild(coverContainer);
            bookItem.appendChild(titleEl);
            bookItem.appendChild(authorEl);
            booksListWrapper.appendChild(bookItem);
        });

        booksContainer.appendChild(booksListWrapper); // å°‡æ›¸ç±åˆ—è¡¨æ·»åŠ åˆ°å®¹å™¨ä¸­

        // ä½¿ç”¨ setTimeout ä¾†è§¸ç™¼æ·¡å…¥å‹•ç•«
        setTimeout(() => {
            booksListWrapper.classList.add('visible');
            // ç•¶æ›¸ç±å€å¡Šå‡ºç¾å¾Œï¼Œå†é¡¯ç¤ºæ¡ˆä¾‹æŒ‰éˆ•
            showCaseBtn.style.display = 'inline-block';
            showCaseBtn.style.opacity = '1';
        }, 100); // çµ¦äºˆ DOM æ›´æ–°å’Œ CSS è¼‰å…¥çš„æ™‚é–“
    }

    // é¡¯ç¤ºç¸½çµé¢æ¿
    function showSummary() {
        // å¡«å…… summary-panel å…§å®¹
        function populateSummaryCol(phase) {
            const d = flightData[phase];
            let htmlContent = `<h3>${d.title}</h3><ul>`;
            d.points.forEach(pt => { htmlContent += `<li>${pt}</li>`; });
            htmlContent += '</ul>';
            document.getElementById(`summary-${phase}`).innerHTML = htmlContent;
        }
        populateSummaryCol('takeoff');
        populateSummaryCol('cruising');
        populateSummaryCol('landing');

        // æ·¡å‡ºé£›è¡Œä¸­çš„å…ƒç´ ï¼Œé¡¯ç¤ºç¸½çµé¢æ¿
        infoPanel.style.opacity='0';
        airplane.style.opacity='0';
        
        setTimeout(() => {
            summaryPanel.style.display = 'flex';
            corePrinciplesPanel.style.opacity = '0'; // ç¢ºä¿æ ¸å¿ƒå¿ƒæ³•é¢æ¿æ˜¯éš±è—çš„
            setTimeout(() => { summaryPanel.style.opacity = '1'; }, 100);
            startBtn.textContent = 'ğŸ¯ æ ¸å¿ƒå¿ƒæ³•ç¸½çµ'; // æ›´æ–°æŒ‰éˆ•æ–‡å­—
            startBtn.classList.add('waiting-for-input'); // æ¢å¾©é–ƒçˆæ•ˆæœ
            startBtn.disabled = false; // å•Ÿç”¨æŒ‰éˆ•
        }, 500); // çµ¦é£›è¡Œå‹•ç•«æ·¡å‡ºæ™‚é–“
        
        flightState='summary_displayed';
        showCaseBtn.style.display = 'none'; // ç¸½çµæ™‚éš±è—æ¡ˆä¾‹æŒ‰éˆ•
    }

    // é¡¯ç¤ºæ ¸å¿ƒå¿ƒæ³•é¢æ¿
    function showCorePrinciples() {
        // æ·¡å‡ºç¸½çµé¢æ¿ï¼Œé¡¯ç¤ºæ ¸å¿ƒå¿ƒæ³•é¢æ¿
        summaryPanel.style.opacity = '0';
        setTimeout(() => {
            summaryPanel.style.display = 'none';
            corePrinciplesPanel.style.display = 'flex';
            corePrinciplesPanel.style.opacity = '1';
            
            // ç‚ºæ¯å€‹å¿ƒæ³•é …ç›®æ·»åŠ æ·¡å…¥å‹•ç•«
            const principles = document.querySelectorAll('.principle-item');
            principles.forEach((item, index) => {
                setTimeout(() => {
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 300 + 300); // æ¯å€‹é …ç›®å»¶é²ä¸åŒ
            });
            // æœ€çµ‚è¨Šæ¯çš„æ·¡å…¥
            const finalMessage = document.querySelector('.final-message');
            setTimeout(() => {
                finalMessage.style.opacity = '1';
                finalMessage.style.transform = 'scale(1)';
            }, principles.length * 300 + 300 + 300); // åœ¨æœ€å¾Œä¸€å€‹é …ç›®ä¹‹å¾Œå†å»¶é²ä¸€é»
        }, 1000); // çµ¦ç¸½çµé¢æ¿æ·¡å‡ºæ™‚é–“
        
        flightState = 'core_principles_displayed';
        startBtn.textContent = 'ğŸ”„ é‡æ–°å•Ÿèˆª'; // æ›´æ–°æŒ‰éˆ•æ–‡å­—
        startBtn.classList.remove('waiting-for-input'); // ç§»é™¤é–ƒçˆæ•ˆæœ
        startBtn.disabled = false; // å•Ÿç”¨æŒ‰éˆ•
        showCaseBtn.style.display = 'none'; // æ ¸å¿ƒå¿ƒæ³•éšæ®µéš±è—æ¡ˆä¾‹æŒ‰éˆ•
    }

    // é‡ç½®é£›è¡Œç‹€æ…‹
    function resetFlight() {
        flightState = 'idle';
        
        // æ·¡å‡ºæ ¸å¿ƒå¿ƒæ³•é¢æ¿
        corePrinciplesPanel.style.opacity = '0';
        // æ¸…ç©ºå„å€‹å¿ƒæ³•é …ç›®çš„å‹•ç•«ç‹€æ…‹
        const principles = document.querySelectorAll('.principle-item');
        principles.forEach(item => {
            item.style.opacity = '0';
            item.style.transform = 'translateY(24px)';
        });
        const finalMessage = document.querySelector('.final-message');
        finalMessage.style.opacity = '0';
        finalMessage.style.transform = 'scale(0.92)';
        
        setTimeout(() => {
            corePrinciplesPanel.style.display = 'none';
            summaryPanel.style.display = 'none'; // ç¢ºä¿ç¸½çµé¢æ¿ä¹Ÿæ˜¯éš±è—çš„
        }, 1000); // ç­‰å¾…æ·¡å‡ºå‹•ç•«å®Œæˆ

        // æ¸…ç©º Canvas
        if (ctx) ctx.clearRect(0,0,canvas.width,canvas.height);
        
        // é‡ç½®è³‡è¨Šé¢æ¿å’Œé£›æ©Ÿ
        infoPanel.style.opacity='0';
        airplane.className = ''; // ç§»é™¤æ‰€æœ‰å‹•ç•«é¡
        airplane.style.cssText = 'opacity: 1;'; // ç¢ºä¿é£›æ©Ÿé‡æ–°é¡¯ç¤º
        void airplane.offsetWidth; // å¼·åˆ¶é‡ç¹ªï¼Œç¢ºä¿å‹•ç•«èƒ½é‡æ–°æ’­æ”¾
        
        // é‡ç½®æŒ‰éˆ•
        startBtn.textContent = 'ğŸš€ å•Ÿå‹•é³³å‡°è¨ˆç•«';
        startBtn.disabled = false;
        startBtn.classList.add('waiting-for-input'); // æ¢å¾©é–ƒçˆæ•ˆæœ
        
        // é‡ç½®æ¡ˆä¾‹é¢æ¿å’ŒæŒ‰éˆ•
        casePanel.style.display='none';
        casePanel.style.opacity='0';
        showCaseBtn.style.display='none';
        showCaseBtn.style.opacity='0';
        currentPhaseForCase = null; // æ¸…ç©ºç•¶å‰éšæ®µ
    }

    // åŸ·è¡Œèµ·é£›å‹•ç•«
    function runTakeoff() {
        flightState = 'animating';
        startBtn.disabled = true;
        startBtn.classList.remove('waiting-for-input');
        startBtn.textContent = 'èµ·é£›ä¸­...';
        
        updateInfoPanel('takeoff'); // æ›´æ–°è³‡è¨Šé¢æ¿
        airplane.classList.add('takeoff'); // æ·»åŠ èµ·é£›å‹•ç•«
        
        setTimeout(() => {
            // å‹•ç•«çµæŸå¾Œçš„ç‹€æ…‹é‡ç½®
            airplane.style.bottom = '80%'; airplane.style.left = '45%'; airplane.style.transform = 'rotate(0deg)';
            flightState = 'takeoff_complete';
            startBtn.disabled = false;
            startBtn.textContent = 'âœˆï¸ é€²å…¥å¹³ç©©é£›è¡Œ';
            startBtn.classList.add('waiting-for-input'); // å•Ÿç”¨é–ƒçˆ
        }, ANIMATION_DURATION);
    }

    // åŸ·è¡Œå¹³ç©©é£›è¡Œå‹•ç•«
    function runCruising() {
        flightState = 'animating';
        startBtn.disabled = true;
        startBtn.classList.remove('waiting-for-input');
        startBtn.textContent = 'å¹³ç©©é£›è¡Œä¸­...';
        
        updateInfoPanel('cruising'); // æ›´æ–°è³‡è¨Šé¢æ¿
        airplane.classList.remove('takeoff'); // ç§»é™¤èˆŠå‹•ç•«
        airplane.classList.add('cruising'); // æ·»åŠ å¹³ç©©é£›è¡Œå‹•ç•«
        
        setTimeout(() => {
            // å‹•ç•«çµæŸå¾Œçš„ç‹€æ…‹é‡ç½®
            airplane.style.bottom = '80%'; airplane.style.left = '80%'; airplane.style.transform = 'rotate(45deg)';
            flightState = 'cruising_complete';
            startBtn.disabled = false;
            startBtn.textContent = 'ğŸ›¬ æº–å‚™é™è½';
            startBtn.classList.add('waiting-for-input'); // å•Ÿç”¨é–ƒçˆ
        }, ANIMATION_DURATION);
    }

    // åŸ·è¡Œé™è½å‹•ç•«
    function runLanding() {
        flightState = 'animating';
        startBtn.disabled = true;
        startBtn.classList.remove('waiting-for-input');
        startBtn.textContent = 'é™è½ä¸­...';
        
        updateInfoPanel('landing'); // æ›´æ–°è³‡è¨Šé¢æ¿
        airplane.classList.remove('cruising'); // ç§»é™¤èˆŠå‹•ç•«
        airplane.classList.add('landing'); // æ·»åŠ é™è½å‹•ç•«
        
        setTimeout(() => {
            // å‹•ç•«çµæŸå¾Œçš„ç‹€æ…‹é‡ç½®
            // é™è½å¾Œé£›æ©Ÿå¯èƒ½å®Œå…¨ç§»å‡ºç•«é¢ï¼Œæ‰€ä»¥é€™è£¡ä¸éœ€è¦è¨­ç½®å…·é«”ä½ç½®ï¼Œåªæ›´æ–°ç‹€æ…‹
            flightState = 'landing_complete';
            startBtn.disabled = false;
            startBtn.textContent = 'ğŸ“Š æŸ¥çœ‹é£›è¡Œç¸½çµ';
            startBtn.classList.add('waiting-for-input'); // å•Ÿç”¨é–ƒçˆ
        }, ANIMATION_DURATION);
    }

    // é¡¯ç¤ºç¸½çµé¢æ¿ä¸¦ç¹ªè£½è·¯å¾‘
    function showSummaryAndPath() {
        // æ·¡å‡ºè³‡è¨Šé¢æ¿å’Œé£›æ©Ÿ
        infoPanel.style.opacity='0';
        airplane.style.opacity='0';
        
        drawFlightPath(); // ç¹ªè£½é£›è¡Œè·¯å¾‘
        
        setTimeout(() => {
            showSummary(); // é¡¯ç¤ºç¸½çµé¢æ¿
        }, 500); // çµ¦äºˆæ·¡å‡ºæ™‚é–“
        
        flightState='summary_displayed';
    }

    // --- ä¸»è¦æµç¨‹æ§åˆ¶ ---
    function handleFlightControl() {
        switch(flightState){
            case 'idle':
                runTakeoff();
                break;
            case 'takeoff_complete':
                runCruising();
                break;
            case 'cruising_complete':
                runLanding();
                break;
            case 'landing_complete':
                showSummaryAndPath();
                break;
            case 'summary_displayed':
                showCorePrinciples();
                break;
            case 'core_principles_displayed':
                resetFlight(); // é»æ“Šå¾Œé‡ç½®å›åˆå§‹ç‹€æ…‹
                break;
        }
    }

    // --- äº‹ä»¶ç›£è½ ---
    
    // é€²å…¥åˆ†äº«æœƒæŒ‰éˆ•
    enterButton.addEventListener('click', function () {
        coverPage.style.opacity = "0";
        setTimeout(() => {
            coverPage.style.display = "none";
            flightContainer.style.display = "block";
            setTimeout(() => {
                flightContainer.style.opacity = "1";
                startBtn.style.display = "block"; // é¡¯ç¤ºå•Ÿå‹•æŒ‰éˆ•
                drawFlightPath(); // é¦–æ¬¡è¼‰å…¥æ™‚ç¹ªè£½è·¯å¾‘
            }, 50);
        }, 800); // èˆ‡ coverPage æ·¡å‡ºå‹•ç•«æ™‚é–“åŒ¹é…
    });

    // å•Ÿå‹•/æ§åˆ¶æŒ‰éˆ•
    startBtn.addEventListener('click', handleFlightControl);

    // å¯¦éš›æ¡ˆä¾‹æŒ‰éˆ•
    showCaseBtn.addEventListener('click', function(){
        if (!currentPhaseForCase) return; // å¦‚æœæ²’æœ‰éšæ®µï¼Œå‰‡ä¸åŸ·è¡Œ
        const caseData = getCaseContentByPhase(currentPhaseForCase); // ç²å–å°æ‡‰éšæ®µçš„æ¡ˆä¾‹å…§å®¹
        
        // å¡«å……æ¡ˆä¾‹é¢æ¿å…§å®¹
        caseImg.src = caseData.img || ''; // é è¨­ç‚ºç©ºå­—ä¸²
        caseTitle.innerHTML = caseData.title || 'ç„¡æ¨™é¡Œ';
        casePoints.innerHTML = '';
        if (caseData.points && caseData.points.length > 0) {
            caseData.points.forEach(pt => {
                const li = document.createElement('li');
                li.innerHTML = pt; // ä½¿ç”¨ innerHTML å…è¨± HTML æ¨™ç±¤
                casePoints.appendChild(li);
            });
        } else {
            casePoints.innerHTML = '<li>æš«ç„¡è©³ç´°èªªæ˜ã€‚</li>';
        }
        
        // é¡¯ç¤ºæ¡ˆä¾‹é¢æ¿
        casePanel.style.display = 'flex';
        setTimeout(()=>{ casePanel.style.opacity='1'; }, 30); // æ·¡å…¥å‹•ç•«
        
        // è®“è³‡è¨Šé¢æ¿ç¨å¾®è®Šæš—ï¼Œçªå‡ºæ¡ˆä¾‹é¢æ¿
        infoPanel.style.opacity='0.6';
        showCaseBtn.style.opacity='0.8'; // ç¨å¾®é™ä½æŒ‰éˆ•é€æ˜åº¦
    });

    // é—œé–‰æ¡ˆä¾‹é¢æ¿æŒ‰éˆ•
    closeCaseBtn.addEventListener('click', function(){
        casePanel.style.opacity='0'; // æ·¡å‡ºå‹•ç•«
        setTimeout(()=>{
            casePanel.style.display='none';
            // æ¢å¾©è³‡è¨Šé¢æ¿å’ŒæŒ‰éˆ•çš„é€æ˜åº¦
            infoPanel.style.opacity='1';
            showCaseBtn.style.opacity='1'; 
        }, 290); // èˆ‡ CSS æ·¡å‡ºå‹•ç•«æ™‚é–“åŒ¹é…
    });

    // å¯¦ä¾‹åˆ†äº« Modal æŒ‰éˆ•
    exampleShareBtn.addEventListener('click', () => {
        exampleModal.style.display = 'flex';
        requestAnimationFrame(()=>{ exampleModal.style.opacity='1'; }); // æ·¡å…¥å‹•ç•«
    });

    // é—œé–‰ Modal æŒ‰éˆ•
    closeExampleModalBtn.addEventListener('click', () => {
        exampleModal.style.opacity = '0';
        // åœ¨éæ¸¡çµæŸå¾Œéš±è— Modal
        exampleModal.addEventListener('transitionend', function handler(){
            exampleModal.style.display='none';
            exampleModal.removeEventListener('transitionend', handler);
        }, {once:true});
    });
    
    // é»æ“Š Modal èƒŒæ™¯é—œé–‰ Modal
    exampleModal.addEventListener('click', function(event){
        if (event.target === exampleModal) { // æª¢æŸ¥æ˜¯å¦é»æ“Šäº†èƒŒæ™¯å€åŸŸ
            closeExampleModalBtn.click(); // è§¸ç™¼é—œé–‰æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶
        }
    });

    // æœ€çµ‚è¨Šæ¯é»æ“Šäº‹ä»¶ (è·³è½‰åˆ° timeline.html)
    document.querySelector('.final-message').addEventListener('click', function(){
        window.open('timeline.html', '_blank'); // åœ¨æ–°åˆ†é æ‰“é–‹
    });

    // --- è¼”åŠ©å‡½æ•¸ ---

    // æ ¹æ“šéšæ®µç²å–æ¡ˆä¾‹å…§å®¹ (ç”¨æ–¼ #show-case-btn)
    function getCaseContentByPhase(phase) {
        const sectionId = flightData[phase].caseId; // å¾ flightData ç²å–å°æ‡‰æ¡ˆä¾‹å€å¡Š ID
        const section = document.getElementById(sectionId); // ç²å– DOM å…ƒç´ 
        if (!section) return { img: '', title: 'æ‰¾ä¸åˆ°æ¡ˆä¾‹å…§å®¹', points: [] }; // å¦‚æœæ‰¾ä¸åˆ°å…ƒç´ ï¼Œè¿”å›é è¨­å€¼

        const imgEl = section.querySelector('img');
        const titleEl = section.querySelector('.example-text-content h3');
        const pointEls = section.querySelectorAll('.example-text-content ul li');
        
        return {
            img: imgEl ? imgEl.src : '', // åœ–ç‰‡ä¾†æº
            title: titleEl ? titleEl.innerHTML : 'ç„¡æ¨™é¡Œ', // æ¡ˆä¾‹æ¨™é¡Œ
            points: Array.from(pointEls).map(li => li.innerHTML) // æ¡ˆä¾‹æ¢åˆ—
        };
    }

    // --- åˆå§‹åŒ– ---
    
    // è¦–çª—å¤§å°æ”¹è®Šæ™‚é‡ç¹ªé£›è¡Œè·¯å¾‘
    window.addEventListener('resize', () => {
        if (flightContainer.style.display !== 'none' && flightContainer.style.opacity !== '0') {
            drawFlightPath();
        }
    });

});
</script>
</body>
</html>